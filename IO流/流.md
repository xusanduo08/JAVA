#### 流

##### 流的分类

1.按处理单位分：__字节流和字符流__

字节流：最小处理单位为字节

* `InputStream`
* `OutputStream`

字符流：最小处理单位为字符，一个字符占用两个字节

* `Reader`
* `Writer`



字节流和字符流按照功能来分的话都是节点流，另外节点流还包括：

* ` FileReader`和`FileWriter`

* `FileInputStream`和`FileOutputStream`

* `ByteArrayInputStream`（将字节数组转化为输入流）和`ByteArrayOutputStream`（捕获内存缓冲区的数据，转换成字节数组，`toByteArray()`方法将流中的数据输出到字节数组）



字节数组节点流，用法如下：

```java
public static byte[] writer(){ // 写出到字节数组中
   String str = "写入到程序中";
   byte[] flush = str.getBytes();
   ByteArrayOutputStream bos = new ByteArrayOutputStream();
   int len = 0;
   bos.write(flush, 0, flush.length); // 将缓冲数据写出到字节数组中
   return bos.toByteArray();
}

public static void read(byte[] data){ // 从字节数组中读取
  InputStream is = new BufferedInputStream(
    new ByteArrayInputStream(data)
  );
  byte[] flush = new byte[1024];
  int len = 0;
  try{
    while(-1!=(len=is.read(flush))){ // 将字节数组转成输入流
      System.out.println(new String(flush, 0, len));
    }
  } catch(IOException e){
     e.printStackTrace();
  } finally {
    try{
      is.close();
    } catch(IOException e){
      e.printStackTrace();
    }
 }

```

2.按功能来分：__节点流和处理流__

* 节点流：上面的字符流和字节流都叫节点流

* 处理流：程序通过一个间接流类去调用节点流类，增强功能，提供性能，处于节点流之上

  * 缓冲流：

    字节缓冲流：`BufferedInputSream`和`BufferedOutputStream`

    字符缓冲流：`BufferedReader`和`BufferedWriter`

  * 转换流：字节流转成字符流，用来处理编码的问题（解码和编码）

  ​           乱码产生原因：编码与解码字符集不统一，字节长度缺失

  ​           输入流：`IutputStreamReader` 二进制----->字符，解码，能指定解码字符集

  ​           输出流：`OutputStreamWriter`

  ```java
  BufferedReader reader = new BufferedReader(
  	new InputStreamReader(new FileInputStream(src)， "utf-8")// 指定解码字符集,然后再将字节转成字符
  )
  ```

3.使用字节数组节点流复制文件

* 文件->文件输入流`FileInputStream`   -> 字节数组输出流 `ByteArrayOutputStream` -> 写入程序
* 程序 -> 字节数组输入流 `ByteArrayInputStream` -> 文件输出流`FileOutputStream`-> 输出到文件

```java
public static byte[] copyFileToByteArray(File source){
  InputStream is = null;
  ByteArrayOutputStream bos = new ByteArrayOutputStream();

  try{
    is = new FileInputStream(source);
    byte[] flush = new byte[1024];
    int len = 0;
    while(-1!=(len=is.read(flush))){ // 将文件读取到字节数组输出流中，然后以字节数组形式输出
      bos.write(flush, 0, len);
    }
    bos.flush();// 注意冲刷管道
  } catch(IOException e){
    e.printStackTrace();
  }
    return bos.toByteArray();
}

  public static void copyFileFromByteArray(byte[] data, String destination){
    // 从字节数组中读取文件 ByteArrayInputStream
    OutputStream os = null;
    File dest = new File(destination);
    InputStream bis =new BufferedInputStream(new ByteArrayInputStream(data));
    byte[] flush = new byte[1024];
    int len = 0;

    try{
      os = new BufferedOutputStream(
        new FileOutputStream(dest)
      );
      while(-1 !=(len=bis.read(flush))){ // 字节数组输入流从字节数组中读取数据存到流中
         os.write(flush, 0, len); // 文件输出流将流写入到文件中
      }
      os.flush(); // 注意冲刷管道
    } catch(IOException e){
      e.printStackTrace();
    } finally {
      try{
        bis.close();
        os.close();
      } catch(IOException e){
         e.printStackTrace();
       }
    }
  }
```

